\section{Naturally variational enforcement for essential boundary conditions}\label{boundary}
\subsection{Discrete equilibrium equations}
With the approximated effective stresses and strains, the last equation of weak form becomes:
\begin{equation}
\begin{split}
&\int_{\Gamma_C} \delta \theta_{\boldsymbol n} M_{\boldsymbol{nn}} d\Gamma 
- \int_{\Gamma_C} \delta \boldsymbol v \cdot \boldsymbol T d\Gamma 
- (\delta \boldsymbol v \cdot \boldlsymbol a_3 P)_{\boldsymbol x\in C_C} 
+ \int_{\Omega_C} \delta \boldsymbol v \cdot \boldsymbol b d\Omega \\
= & - \int_{\Gamma_C} \delta \boldsymbol v \cdot \boldsymbol T_N d\Gamma 
+ \int_{\Omega_C} \delta \boldsymbol v \cdot \boldsymbol b_N d\Omega \\
+&\int_{\Gamma_C} \delta \theta_{\boldsymbol n} M_{\boldsymbol{nn}} d\Gamma 
- \int_{\Gamma_C} \delta \boldsymbol v \cdot \boldsymbol T_M d\Gamma 
- (\delta \boldsymbol v \cdot \boldlsymbol a_3 P)_{\boldsymbol x\in C_C} 
+ \int_{\Omega_C} \delta \boldsymbol v \cdot \boldsymbol b_M d\Omega \\
=& -\sum_{I=1}^{n_p} \delta \boldsymbol d_I \cdot (
\tilde{\boldsymbol g}_{\alpha I}^T \boldsymbol d^\alpha_N + \tilde{\boldsymbol g}_{\alpha\beta}^T \boldsymbol d^{\alpha\beta}_M) \\
=& -\sum_{I=1}^{n_p} \delta \boldsymbol d_I \cdot (
(\boldsymbol G^{-1}\tilde{\boldsymbol g}_{\alpha I})^T \boldsymbol G^{\alpha\eta}_N \cdot \boldsymbol d^\varepsilon_\eta) \\
=& -\sum_{I=1}^{n_p} \delta \boldsymbol d_I \cdot (
(\boldsymbol G^{-1}\tilde{\boldsymbol g}_{\alpha I})^T \int_{\Omega_C} \boldsymbol a_\beta \boldsymbol q h C^{\alpha\beta\gamma\eta} \boldsymbol q^T \boldsymbol a_\gamma \cdot \boldsymbol d^\varepsilon_\eta d\Omega) \\
= &\int_{\Omega_C} \delta \tilde \varepsilon_{\alpha\beta} (\tilde N^{\alpha\beta} - \bar N^{\alpha\beta} + \hat N^{\alpha\beta}) d\Omega
\end{split}
\end{equation}
\begin{equation}\label{w51}
- \sum_{C=1}^{n_e}\sum_{I=1}^{n_p} \delta \boldsymbol d_I \cdot \left ( (\tilde{\boldsymbol g}^T_{\alpha I} - \bar{\boldsymbol g}^T_{\alpha I}) \boldsymbol d_N^{\alpha}
+ (\tilde{\boldsymbol g}^T_{\alpha\beta I} - \bar{\boldsymbol g}^T_{\alpha\beta I}) \boldsymbol d_M^{\alpha\beta} \right ) = - \sum_{I=1}^{n_p}\delta d_I \cdot \boldsymbol f_I
\end{equation}
where $\boldsymbol f_I$'s are the components of the traditional force vector:
\begin{equation}
        \boldsymbol f_I = \int_{\Gamma_t} \Psi_I \bar{\boldsymbol t} d\Gamma - \int_{\Gamma_M} \Psi_{I,\gamma} n^\gamma \bar M_{\boldsymbol{nn}} d\Gamma + [[\Psi_I\boldsymbol a_3 \bar P]]_{\boldsymbol x\in C_P} + \int_\Omega \Psi_I \bar{\boldsymbol b} d\Omega
\end{equation}

\begin{equation}
\begin{split}
\sum_{I=1}^{n_p} \delta \boldsymbol d_I \cdot \tilde{\boldsymbol g}^T_{\alpha I} \boldsymbol d_N^\alpha 
&= \sum_{I=1}^{n_p} \delta \boldsymbol d_I \cdot (\boldsymbol G^{-1} \tilde{\boldsymbol g}_{\alpha I})^T  \boldsymbol G \boldsymbol d^\alpha_N \\
&= \int_{\Omega_C} \sum_{I=1}^{n_p} \delta \boldsymbol d_I \cdot (\boldsymbol q^T\boldsymbol G^{-1} \tilde{\boldsymbol g}_{\alpha I})^T  \boldsymbol q^T \boldsymbol d^\alpha_N d\Omega \\
&= \int_{\Omega_C} \sum_{I=1}^{n_p} \delta \boldsymbol d_I \cdot \boldsymbol a_\beta(\boldsymbol q^T\boldsymbol G^{-1} \tilde{\boldsymbol g}_{\alpha I})^T  N^{\alpha\beta h} d\Omega \\
& = \int_{\Omega_C} \delta \tilde \varepsilon_{\alpha\beta}^h N^{\alpha\beta h} d\Omega 
\end{split}
\end{equation}
\begin{equation}
\begin{split}
&\sum_{I=1}^{n_p} \delta \boldsymbol d_I \cdot  \left ( 
(\tilde{\boldsymbol g}^T_{\alpha I} - \bar{\boldsymbol g}^T_{\alpha I}) \boldsymbol d^\alpha_N
+(\tilde{\boldsymbol g}^T_{\alpha\beta I} - \bar{\boldsymbol g}^T_{\alpha\beta I}) \boldsymbol d^{\alpha\beta}_M) \\
=& \int_{\Omega_C}\left ( (\delta \tilde \varepsilon_{\alpha\beta} - \delta \bar \varepsilon_{\alpha\beta}) N^{\alpha\beta h}
+ (\delta \tilde \kappa_{\alpha\beta} - \delta \bar \kappa_{\alpha\beta})M^{\alpha\beta h}
\right ) d\Omega
\end{split}
\right )
\end{equation}
\begin{equation}
\begin{split}
&\int_{\Omega_C} \delta \tilde \varepsilon_{\alpha\beta} N^{\alpha\beta h} d\Omega \\
=&\int_{\Omega_C} \delta \tilde \varepsilon_{\alpha\beta} N^{\alpha\beta h} d\Omega \\
\end{split}
\end{equation}
and further substituting coefficients $\boldsymbol d_N^\alpha$, $\boldsymbol d_M^{\alpha\beta}$ into Eq. (\ref{w51}) gives the final discrete equilibrium equations: 
\begin{equation}
\begin{split}
&- \sum_{C=1}^{n_c}(\tilde{\boldsymbol g}^T_{\alpha I} - \bar{\boldsymbol g}^T_{\alpha I}) \boldsymbol d_N^{\alpha}
- \sum_{C=1}^{n_c}(\tilde{\boldsymbol g}^T_{\alpha\beta I} - \bar{\boldsymbol g}^T_{\alpha\beta I}) \boldsymbol d_M^{\alpha\beta} \\
= &\sum_{C=1}^{n_e} \sum_{J=1}^{n_p} \left (
\begin{split}
& \boldsymbol a_\alpha \tilde{\boldsymbol g}^T_{\beta I} h C^{\alpha\beta\gamma\eta} \boldsymbol a_\gamma \tilde{\boldsymbol g}_{\eta J} 
+ \tilde{\boldsymbol g}^T_{\alpha\beta I} \boldsymbol a_3 \frac{h^3}{12}C^{\alpha\beta\gamma\eta} \boldsymbol a_3 \tilde{\boldsymbol g}_{\gamma\eta} \\
- & \boldsymbol a_\alpha \bar{\boldsymbol g}^T_{\beta I} h C^{\alpha\beta\gamma\eta} \boldsymbol a_\gamma \tilde{\boldsymbol g}_{\eta J} - \boldsymbol a_\alpha \tilde{\boldsymbol g}^T_{\beta I} h C^{\alpha\beta\gamma\eta} \boldsymbol a_\gamma \bar{\boldsymbol g}_{\eta J} \\
- & \bar{\boldsymbol g}^T_{\alpha\beta I}\boldsymbol a_3 \frac{h^3}{12} C^{\alpha\beta\gamma\eta} \boldsymbol a_3 \tilde{\boldsymbol g}_{\gamma\eta J} - \tilde{\boldsymbol g}^T_{\alpha\beta I} \boldsymbol a_3 \frac{h^3}{12} C^{\alpha\beta\gamma\eta} \boldsymbol a_3 \bar{\boldsymbol g}_{\gamma\eta J} \\
+ & \boldsymbol a_\alpha \tilde{\boldsymbol g}^T_{\beta I} h C^{\alpha\beta\gamma\eta} \boldsymbol a_\gamma \hat{\boldsymbol g}_{\eta J}
- \boldsymbol a_\alpha \bar{\boldsymbol g}^T_{\beta I} h C^{\alpha\beta\gamma\eta} \boldsymbol a_\gamma \hat{\boldsymbol g}_{\eta J} \\
+ & \tilde{\boldsymbol g}^T_{\alpha\beta I}\boldsymbol a_3 \frac{h^3}{12} C^{\alpha\beta\gamma\eta} \boldsymbol a_3 \hat{\boldsymbol g}_{\gamma\eta J} - \bar{\boldsymbol g}^T_{\alpha\beta I} \boldsymbol a_3 \frac{h^3}{12} C^{\alpha\beta\gamma\eta} \boldsymbol a_3 \hat{\boldsymbol g}_{\gamma\eta J} \\
+ & \boldsymbol a_\alpha \bar{\boldsymbol g}^T_{\beta I} h C^{\alpha\beta\gamma\eta} \boldsymbol a_\gamma \bar{\boldsymbol g}_{\eta J}
+ \bar{\boldsymbol g}^T_{\alpha\beta I}\boldsymbol a_3 \frac{h^3}{12} C^{\alpha\beta\gamma\eta} \boldsymbol a_3 \bar{\boldsymbol g}_{\gamma\eta J} 
\end{split}
\right ) \\
= &\sum_{J=1}^{n_p} (\boldsymbol K_{IJ}+\tilde{\boldsymbol K}_{IJ}+\bar{\boldsymbol K}_{IJ}) \cdot \boldsymbol d_J - \tilde{\boldsymbol f}_I - \bar{\boldsymbol f}_I
\end{split}
\end{equation}
where
\begin{equation}\label{de1}
        \boldsymbol K_{IJ} = \int_\Omega \tilde{\boldsymbol \varepsilon}_{\alpha\beta I} \tilde{\boldsymbol N}^{\alpha\beta}_J d\Omega + \int_\Omega \tilde{\boldsymbol \kappa}_{\alpha\beta I} \tilde{\boldsymbol M}^{\alpha\beta}_J d\Omega
\end{equation}
\begin{subequations}\label{de2}
\begin{align}
\begin{split}
        \tilde{\boldsymbol K}_{IJ} = &- \int_{\Gamma_v} (\Psi_I \tilde{\boldsymbol t}_J + \tilde{\boldsymbol t}_I \Psi_J) d\Gamma \\
                                     &+ \int_{\Gamma_\theta} (\Psi_{I,\gamma} n^\gamma \boldsymbol a_3 \tilde M_{\boldsymbol{nn}J} + \boldsymbol a_3 \tilde M_{\boldsymbol{nn}I} \Psi_{I,\gamma}n^\gamma)d\Gamma \\
                                     & + ([[\Psi_I \boldsymbol a_3 P_J]] + [[P_I \boldsymbol a_3 \Psi_J]])_{\boldsymbol x \in C_v}
\end{split} \\
\tilde{\boldsymbol f}_I = &- \int_{\Gamma_v} \tilde{\boldsymbol t}_I \cdot \bar{\boldsymbol v} d\Gamma + \int_{\Gamma_\theta} \tilde M_{\boldsymbol{nn}} \bar{\theta}_{\boldsymbol n} d\Gamma + [[\tilde P_I\boldsymbol a_3 \cdot \bar{\boldsymbol v}]]_{\boldsymbol x \in C_v}
\end{align}
\end{subequations}
\begin{subequations}\label{de3}
\begin{align}
\bar{\boldsymbol K}_{IJ} &= - \int_{\Gamma_v} \bar{\boldsymbol t}_I \Psi_J d\Gamma 
+ \int_{\Gamma_\theta} \boldsymbol a_3\bar M_{\boldsymbol{nn}I} \Psi_{J,\gamma}n^\gamma d\Gamma + [[\bar P_I \boldsymbol a_3 \Psi_J]]_{\boldsymbol x \in C_v} \\
\bar{\boldsymbol f}_I &= - \int_{\Gamma_v} \bar{\boldsymbol t}_I \cdot \bar{\boldsymbol v} d\Gamma + \int_{\Gamma_\theta} \bar M_{\boldsymbol{nn}} \bar{\theta}_{\boldsymbol n} d\Gamma + [[\bar P_I\boldsymbol a_3 \cdot \bar{\boldsymbol v}]]_{\boldsymbol x \in C_v}
\end{align}
\end{subequations}

The detailed derivations of Eqs (\ref{de1})-(\ref{de3}) are listed in the Appendix. As shown in these equations, the Eq. (\ref{de1}) is the conventional stiffness matrix evaluated by smoothed gradients $\tilde \Psi_{I,\alpha}$, $\tilde \Psi_{I,\alpha}\vert_\beta$, and the Eqs. (\ref{de2}) and (\ref{de3}) contribute for the enforcement of essential boundary. 

\subsection{Comparison with Nitsche's method}
The Nitsche's method for enforcing essential boundary can be regarded as a combination of Lagrangian multiplier method and penalty method, in which the Lagrangian multiplier is represented by the approximated displacement. The corresponding total potential energy functional $\Pi_P$ is given by:
\begin{equation}
\begin{split}
\Pi_P(\boldsymbol v) &= \int_\Omega \frac{1}{2}\varepsilon_{\alpha\beta} N^{\alpha\beta} d\Omega +
\int_\Omega \frac{1}{2} \kappa_{\alpha\beta}M^{\alpha\beta} d\Omega \\
                     &- \int_{\Gamma_t} \boldsymbol v \cdot \bar{\boldsymbol t} d\Gamma 
                     + \int_{\Gamma_M} \boldsymbol v_{,\gamma} n^\gamma \boldsymbol a_3 M_{\boldsymbol{nn}} d\Gamma
                     + (\boldsymbol v \cdot \boldsymbol a_3 P)_{\boldsymbol x \in C_P}
                     - \int_\Omega \boldsymbol v \cdot \bar{\boldsymbol b} d\Omega \\
                     &- \underbrace{\int_{\Gamma_v} \boldsymbol t \cdot (\boldsymbol v - \bar{\boldsymbol v}) d\Gamma
                     + \int_{\Gamma_\theta} M_{\boldsymbol{nn}}(\theta_{\boldsymbol n} - \bar \theta_{\boldsymbol n})d\Gamma
                     + (P\boldsymbol a_3 \cdot (\boldsymbol v - \bar{\boldsymbol v}))_{\boldsymbol x \in C_v}}_{\text{consistent term}} \\
                     &+ \underbrace{\frac{\alpha_v}{2} \int_{\Gamma_v} \boldsymbol v \cdot \boldsymbol v d\Gamma 
                     + \frac{\alpha_\theta}{2} \int_{\Gamma_\theta} \theta_{\boldsymbol n}^2 d\Gamma
             + \frac{\alpha_C}{2}(\boldsymbol v \cdot \boldsymbol v)_{\boldsymbol x\in C_v}}_{\text{stabilized term}}
\end{split}
\end{equation}
where the consistent term rephrased from Lagrangian multiplier method contributes to enforce the essential boundary and meet the variational consistency condition. However the consistent term can not always ensure the coercivity of stiffness, so the penalty method is introduced to be regarded as a stabilized term. With a standard variational argument, the corresponding weak form can be stated as:
\begin{equation}
\begin{split}
\delta \Pi_P(\boldsymbol v) &= \int_\Omega\delta \varepsilon_{\alpha\beta} N^{\alpha\beta} d\Omega +
\int_\Omega \delta \kappa_{\alpha\beta}M^{\alpha\beta} d\Omega \\
                     &- \int_{\Gamma_t} \delta \boldsymbol v \cdot \bar{\boldsymbol t} d\Gamma 
                     + \int_{\Gamma_M} \delta \boldsymbol v_{,\gamma} n^\gamma \boldsymbol a_3 M_{\boldsymbol{nn}} d\Gamma
                     + (\delta \boldsymbol v \cdot \boldsymbol a_3 P)_{\boldsymbol x \in C_P}
                     - \int_\Omega \delta \boldsymbol v \cdot \bar{\boldsymbol b} d\Omega \\
                     &- \int_{\Gamma_v} \delta \boldsymbol v \cdot \boldsymbol t d\Gamma 
                     + \int_{\Gamma_\theta} \delta \theta_{\boldsymbol n} M_{\boldsymbol{nn}}d\Gamma 
                     + (\boldsymbol v \cdot \boldsymbol a_3 P)_{\boldsymbol x \in C_v}\\
                     &- \int_{\Gamma_v} \delta \boldsymbol t \cdot (\boldsymbol v - \bar{\boldsymbol v}) d\Gamma
                     + \int_{\Gamma_\theta} \delta M_{\boldsymbol{nn}}(\theta_{\boldsymbol n} - \bar \theta_{\boldsymbol n})d\Gamma
                     + (\delta P\boldsymbol a_3 \cdot (\boldsymbol v - \bar{\boldsymbol v}))_{\boldsymbol x \in C_v} \\
                     &+ \alpha_v \int_{\Gamma_v} \delta \boldsymbol v \cdot \boldsymbol v d\Gamma 
                     + \alpha_\theta \int_{\Gamma_\theta} \delta \theta_{\boldsymbol n}\theta_{\boldsymbol n} d\Gamma
                     + \alpha_C(\delta \boldsymbol v \cdot \boldsymbol v)_{\boldsymbol x\in C_v} \\
                     &= 0
\end{split}
\end{equation}
in which $\alpha_v$, $\alpha_\theta$ and $\alpha_C$ are experimental artificial parameters. Further invoking the conventional reproducing kernel approximation of Eq. (\ref{approxv}) leads to the following discrete equilibrium equations:
\begin{equation}
\sum_{J=1}^{n_p}(\boldsymbol K_{IJ} + \boldsymbol K^c_{IJ} + \boldsymbol K^s_{IJ}) \boldsymbol d_J = \boldsymbol f_I + \boldsymbol f^c + \boldsymbol f^s
\end{equation}
where the stiffness $\boldsymbol K_{IJ}$ is identical with Eq. (\ref{de1}). $\boldsymbol K^c_{IJ}$ and $\boldsymbol K^s_{IJ}$ are the stiffness matrix for consistent and stabilized terms respectively, and have the following forms:
\begin{subequations}
\begin{equation}
\begin{split}
        \boldsymbol K^c_{IJ} &= -\int_{\Gamma_v} \left ((\boldsymbol {\mathcal T}^\alpha \Psi_{I,\alpha} + \boldsymbol{\mathcal V}^{\alpha\beta} \Psi_{I,\alpha}\vert_\beta) \Psi_J + \Psi_I (\boldsymbol {\mathcal T}^\alpha \Psi_{J,\alpha} + \boldsymbol{\mathcal V}^{\alpha\beta}\Psi_{J,\alpha}\vert_\beta)\right ) d\Gamma \\
                             &+ \int_{\Gamma_M} (\mathcal M^{\alpha\beta} \Psi_{I,\alpha}\vert_\beta \boldsymbol a_3 \Psi_{J,\gamma}n^\gamma + \Psi_{I,\gamma}n^\gamma \boldsymbol a_3 \mathcal M^{\alpha\beta} \Psi_{I,\alpha}\vert_\beta) d\Gamma
\end{split}
\end{equation}
\end{subequations}
